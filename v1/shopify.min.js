"use strict"
!function(){if(document.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="https://rawgit.com/PostCo/postco-shopify/master/v1/shopify.min.css">'),void 0===window.jQuery){var e=document.createElement("script")
e.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",document.head.appendChild(e)}if("object"==typeof dojo)var t=require("jquery")
var n=function(){var e="https:"===window.location.protocol?"https:":"http:",t="//query.yahooapis.com/v1/public/yql?q=",n=encodeURIComponent("select * from html where url = ")
return function(o){return e+t+n+"%27"+encodeURIComponent(o)+"%27"}}(),o=function(){return"undefined"!=typeof window.DOMParser?function(e){return(new DOMParser).parseFromString(e,"text/xml")}:"undefined"!=typeof ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")?function(e){var t=new ActiveXObject("Microsoft.XMLDOM")
return t.async="false",t.loadXML(e),t}:(console.log("inject - no xml parser found."),function(e){return null})}(),a=function(){function e(){var e=new XMLHttpRequest
return"withCredentials"in e}var t=null
return"undefined"!=typeof XMLHttpRequest&&e()?t=function(){return new XMLHttpRequest}:"undefined"!=typeof XDomainRequest?t=function(){return new XDomainRequest}:console.log("inject - cors isn't supported."),t}(),i=function(e,t){var n=a()
null!==n&&(n.open("GET",e,!0),n.onerror=function(){console.log("inject - error making a request for a source's HTML.")},n.onload=function(){t(n.responseText)},n.send(null))},r=function(){return"undefined"!=typeof document.querySelectorAll?function(e){return document.querySelectorAll("["+e+"]")}:function(e){for(var t=[],n=document.getElementsByTagName("*"),o=0,a=n.length;o<a;o++)null!==n[o].getAttribute(e)&&t.push(n[o])
return t}}(),s=function(e,t,n){for(var o=e.getElementsByTagName(n),a=0,i=o.length;a<i;a++)t.push(o[a])
return t},c=function(e,n){var a=o(e)
if(null!==a){var i=a.getElementsByTagName("body")
if(1===i.length){var r=i[0],c=[]
c=s(a,c,"script"),c=s(a,c,"style")
for(var d=0,l=c.length;d<l;d++)c[d].parentNode.removeChild(c[d])
n.innerHTML=r.innerHTML||r.xml||e,t.getScript("https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.1/js/standalone/selectize.min.js").done(function(e,t){initializeSelectize()}).fail(function(e,t,n){console.log("Selectize failed to load")}),t.getScript("https://cdnjs.cloudflare.com/ajax/libs/remodal/1.1.0/remodal.min.js").done(function(e,n){t(".remodal").remodal()}).fail(function(e,t,n){console.log("Remodal failed to load")})}else console.log("inject - no body tag found.")}},d="data-pc-src",l="/plugins/v1/shopify",u=function(e){var t=e.getAttribute(d)+l
i(n(t),function(t){c(t,e)})}
setTimeout(function(){for(var e=r(d),t=0,n=e.length;t<n;t++)u(e[t])},0)}()
var initializeSelectize=function(){var e=document.getElementById("postco-plugin"),t=e.dataset.pcApi,n=e.dataset.pcSrc
$("#js-postco-shipping").click(function(){$("#js-postco-widget").hide(),$("#js-postco-fields").attr("disabled",!0)}),$("#js-postco-collect").click(function(){$("#js-postco-widget").show(),$("#js-postco-fields").attr("disabled",!1)}),$("#postco-agent").selectize({preload:!0,valueField:"id",labelField:"name",searchField:["name","address1","address2","zip","city"],render:{option:function(e,t){return'<div data-address1="'+e.address1+'" data-address2="'+e.address2+'" data-city="'+e.city+'" data-zip="'+e.zip+'" data-province="'+e.province+'" data-country="'+e.country+'"><span class="title"><span class="name" style="font-weight:bold;">'+e.name+'</span></span><br><span class="address" style="font-size: small;">'+(e.address1+" "+e.address2+" "+e.zip+" "+e.city)+"</span></div>"}},onItemAdd:function(e,t){var n=t.text(),o=$(".selectize-dropdown-content").find('[data-value="'+e+'"]'),a=$.param({step:"contact_information",checkout:{shipping_address:{company:n,address1:o.data("address1"),address2:o.data("address2"),city:o.data("city"),zip:o.data("zip"),province:o.data("province"),country:o.data("country")}}})
$('form[action="/cart"]').attr("action","cart?"+a)},load:function(e,o){this.settings.load=null,$.ajax({url:n+"/api/v1/locations",xhrFields:{withCredentials:!0},headers:{Authorization:"Bearer "+t},type:"GET",error:function(){o()},success:function(e){var t=e.data.map(function(e){return{id:e.attributes["agent-id"],name:e.attributes.company,address1:e.attributes.address1,address2:e.attributes.address2,city:e.attributes.city,zip:e.attributes.zip,province:e.attributes.state,country:e.attributes.country}})
o(t)}})}})}
