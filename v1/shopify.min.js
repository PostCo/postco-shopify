"use strict"
!function(){if(document.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="https://cdn.rawgit.com/PostCo/postco-shopify/v1.7.18/v1/shopify.min.css">'),void 0===window.jQuery){var t=document.createElement("script")
t.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",document.head.appendChild(t)}"object"==typeof dojo&&($=require("jquery"))
var e=function(){var t="https:"===window.location.protocol?"https:":"http:",e="//query.yahooapis.com/v1/public/yql?q=",n=encodeURIComponent("select * from html where url = ")
return function(o){return t+e+n+"%27"+encodeURIComponent(o)+"%27"}}(),n=function(){return"undefined"!=typeof window.DOMParser?function(t){return(new DOMParser).parseFromString(t,"text/xml")}:"undefined"!=typeof ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")?function(t){var e=new ActiveXObject("Microsoft.XMLDOM")
return e.async="false",e.loadXML(t),e}:(console.log("inject - no xml parser found."),function(t){return null})}(),o=function(){function t(){var t=new XMLHttpRequest
return"withCredentials"in t}var e=null
return"undefined"!=typeof XMLHttpRequest&&t()?e=function(){return new XMLHttpRequest}:"undefined"!=typeof XDomainRequest?e=function(){return new XDomainRequest}:console.log("inject - cors isn't supported."),e}(),s=function(t,e){var n=o()
null!==n&&(n.open("GET",t,!0),n.onerror=function(){console.log("inject - error making a request for a source's HTML.")},n.onload=function(){e(n.responseText)},n.send(null))},r=function(){return"undefined"!=typeof document.querySelectorAll?function(t){return document.querySelectorAll("["+t+"]")}:function(t){for(var e=[],n=document.getElementsByTagName("*"),o=0,s=n.length;o<s;o++)null!==n[o].getAttribute(t)&&e.push(n[o])
return e}}(),i=function(t,e,n){for(var o=t.getElementsByTagName(n),s=0,r=o.length;s<r;s++)e.push(o[s])
return e},a=function(t,e){var o=n(t)
if(null!==o){var s=o.getElementsByTagName("body")
if(1===s.length){var r=s[0],a=[]
a=i(o,a,"script"),a=i(o,a,"style")
for(var c=0,d=a.length;c<d;c++)a[c].parentNode.removeChild(a[c])
e.innerHTML=r.innerHTML||r.xml||t,$.getScript("https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.1/js/standalone/selectize.min.js").done(function(t,e){initializeSelectize()}).fail(function(t,e,n){console.log("Selectize failed to load")}),$("#js-postco-shipping").click()}else console.log("inject - no body tag found.")}},c="data-pc-src",d="/plugins/v1/shopify",u=function(t){var n=t.getAttribute(c)+d
s(e(n),function(e){a(e,t)})}
setTimeout(function(){for(var t=r(c),e=0,n=t.length;e<n;e++)u(t[e])},0)}()
var initializeSelectize=function(){var t=document.getElementById("postco-plugin"),e=t.dataset.pcApi,n=t.dataset.pcSrc
$("#js-postco-shipping").click(function(){$("#js-postco-widget").hide(),$("#js-postco-checkout").show(),$("#js-postco-fields").attr("disabled",!0),$("form.js-cart").attr("action","/cart")}),$("#js-postco-collect").click(function(){$("#js-postco-checkout").hide(),$("#js-postco-widget").show(),$("#js-postco-fields").attr("disabled",!1)}),$("#postco-agent").selectize({preload:!0,valueField:"id",labelField:"name",searchField:["name","address1","address2","zip","city"],render:{option:function(t,e){return'<div data-address1="'+t.address1+'" data-address2="'+t.address2+'" data-city="'+t.city+'" data-zip="'+t.zip+'" data-province="'+t.province+'" data-country="'+t.country+'"><span class="title"><span class="name" style="font-weight:bold;">'+t.name+'</span></span><br><span class="address" style="font-size: small;">'+(t.address1+" "+t.address2+" "+t.zip+" "+t.city)+"</span></div>"}},onItemAdd:function(t,e){var n=e.text(),o=$(".selectize-dropdown-content").find('[data-value="'+t+'"]'),s=$.param({step:"contact_information",checkout:{shipping_address:{company:n,address1:o.data("address1"),address2:o.data("address2"),city:o.data("city"),zip:o.data("zip"),province:o.data("province"),country:o.data("country")}}})
$("form.js-cart").attr("action","cart?"+s)},load:function(t,o){this.settings.load=null,$.ajax({url:n+"/api/v1/locations",xhrFields:{withCredentials:!0},headers:{Authorization:"Bearer "+e},type:"GET",error:function(){o()},success:function(t){var e=t.data.map(function(t){return{id:t.attributes["agent-id"],name:t.attributes.company,address1:t.attributes.address1+", "+t.attributes.address2,address2:t.attributes.address3,city:t.attributes.city,zip:t.attributes.zip,province:t.attributes.state,country:t.attributes.country}})
o(e)}})}})}
