"use strict"
!function(){if(document.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="https://rawgit.com/PostCo/postco-shopify/master/v1/shopify.min.css">'),void 0===window.jQuery){var e=document.createElement("script")
e.src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js",document.head.appendChild(e)}"object"==typeof dojo&&($=require("jquery"))
var t=function(){var e="https:"===window.location.protocol?"https:":"http:",t="//query.yahooapis.com/v1/public/yql?q=",n=encodeURIComponent("select * from html where url = ")
return function(o){return e+t+n+"%27"+encodeURIComponent(o)+"%27"}}(),n=function(){return"undefined"!=typeof window.DOMParser?function(e){return(new DOMParser).parseFromString(e,"text/xml")}:"undefined"!=typeof ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")?function(e){var t=new ActiveXObject("Microsoft.XMLDOM")
return t.async="false",t.loadXML(e),t}:(console.log("inject - no xml parser found."),function(e){return null})}(),o=function(){function e(){var e=new XMLHttpRequest
return"withCredentials"in e}var t=null
return"undefined"!=typeof XMLHttpRequest&&e()?t=function(){return new XMLHttpRequest}:"undefined"!=typeof XDomainRequest?t=function(){return new XDomainRequest}:console.log("inject - cors isn't supported."),t}(),i=function(e,t){var n=o()
null!==n&&(n.open("GET",e,!0),n.onerror=function(){console.log("inject - error making a request for a source's HTML.")},n.onload=function(){t(n.responseText)},n.send(null))},a=function(){return"undefined"!=typeof document.querySelectorAll?function(e){return document.querySelectorAll("["+e+"]")}:function(e){for(var t=[],n=document.getElementsByTagName("*"),o=0,i=n.length;o<i;o++)null!==n[o].getAttribute(e)&&t.push(n[o])
return t}}(),r=function(e,t,n){for(var o=e.getElementsByTagName(n),i=0,a=o.length;i<a;i++)t.push(o[i])
return t},s=function(e,t){var o=n(e)
if(null!==o){var i=o.getElementsByTagName("body")
if(1===i.length){var a=i[0],s=[]
s=r(o,s,"script"),s=r(o,s,"style")
for(var c=0,d=s.length;c<d;c++)s[c].parentNode.removeChild(s[c])
t.innerHTML=a.innerHTML||a.xml||e,$.getScript("https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.1/js/standalone/selectize.min.js").done(function(e,t){initializeSelectize()}).fail(function(e,t,n){console.log("Selectize failed to load")}),$.getScript("https://cdnjs.cloudflare.com/ajax/libs/remodal/1.1.0/remodal.min.js").done(function(e,t){initializeRemodal()}).fail(function(e,t,n){console.log("Remodal failed to load")})}else console.log("inject - no body tag found.")}},c="data-pc-src",d="/plugins/v1/shopify",l=function(e){var n=e.getAttribute(c)+d
i(t(n),function(t){s(t,e)})}
setTimeout(function(){for(var e=a(c),t=0,n=e.length;t<n;t++)l(e[t])},0)}()
var initializeRemodal=function(){$(".remodal").remodal()},initializeSelectize=function(){var e=document.getElementById("postco-plugin"),t=e.dataset.pcApi,n=e.dataset.pcSrc
$("#js-postco-shipping").click(function(){$("#js-postco-widget").hide(),$("#js-postco-fields").attr("disabled",!0)}),$("#js-postco-collect").click(function(){$("#js-postco-widget").show(),$("#js-postco-fields").attr("disabled",!1)}),$("#postco-agent").selectize({preload:!0,valueField:"id",labelField:"name",searchField:["name","address1","address2","zip","city"],render:{option:function(e,t){return'<div data-address1="'+e.address1+'" data-address2="'+e.address2+'" data-city="'+e.city+'" data-zip="'+e.zip+'" data-province="'+e.province+'" data-country="'+e.country+'"><span class="title"><span class="name" style="font-weight:bold;">'+e.name+'</span></span><br><span class="address" style="font-size: small;">'+(e.address1+" "+e.address2+" "+e.zip+" "+e.city)+"</span></div>"}},onItemAdd:function(e,t){var n=t.text(),o=$(".selectize-dropdown-content").find('[data-value="'+e+'"]'),i=$.param({step:"contact_information",checkout:{shipping_address:{company:n,address1:o.data("address1"),address2:o.data("address2"),city:o.data("city"),zip:o.data("zip"),province:o.data("province"),country:o.data("country")}}})
$("form.cart").attr("action","cart?"+i)},load:function(e,o){this.settings.load=null,$.ajax({url:n+"/api/v1/locations",xhrFields:{withCredentials:!0},headers:{Authorization:"Bearer "+t},type:"GET",error:function(){o()},success:function(e){var t=e.data.map(function(e){return{id:e.attributes["agent-id"],name:e.attributes.company,address1:e.attributes.address1,address2:e.attributes.address2,city:e.attributes.city,zip:e.attributes.zip,province:e.attributes.state,country:e.attributes.country}})
o(t)}})}})}
