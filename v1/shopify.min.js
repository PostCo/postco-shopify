"use strict"
!function(){var t=function(){var t="https:"===window.location.protocol?"https:":"http:",e="//query.yahooapis.com/v1/public/yql?q=",n=encodeURIComponent("select * from html where url = ")
return function(o){return t+e+n+"%27"+encodeURIComponent(o)+"%27"}}(),e=function(){return"undefined"!=typeof window.DOMParser?function(t){return(new DOMParser).parseFromString(t,"text/xml")}:"undefined"!=typeof ActiveXObject&&new ActiveXObject("Microsoft.XMLDOM")?function(t){var e=new ActiveXObject("Microsoft.XMLDOM")
return e.async="false",e.loadXML(t),e}:(console.log("inject - no xml parser found."),function(t){return null})}(),n=function(){function t(){var t=new XMLHttpRequest
return"withCredentials"in t}var e=null
return"undefined"!=typeof XMLHttpRequest&&t()?e=function(){return new XMLHttpRequest}:"undefined"!=typeof XDomainRequest?e=function(){return new XDomainRequest}:console.log("inject - cors isn't supported."),e}(),o=function(t,e){var o=n()
null!==o&&(o.open("GET",t,!0),o.onerror=function(){console.log("inject - error making a request for a source's HTML.")},o.onload=function(){e(o.responseText)},o.send(null))},i=function(){return"undefined"!=typeof document.querySelectorAll?function(t){return document.querySelectorAll("["+t+"]")}:function(t){for(var e=[],n=document.getElementsByTagName("*"),o=0,i=n.length;o<i;o++)null!==n[o].getAttribute(t)&&e.push(n[o])
return e}}(),a=function(t,e,n){for(var o=t.getElementsByTagName(n),i=0,a=o.length;i<a;i++)e.push(o[i])
return e},r=function(t,n){var o=e(t)
if(null!==o){var i=o.getElementsByTagName("body")
if(1===i.length){var r=i[0],s=[]
s=a(o,s,"script"),s=a(o,s,"style")
for(var c=0,d=s.length;c<d;c++)s[c].parentNode.removeChild(s[c])
n.innerHTML=r.innerHTML||r.xml||t,document.head.insertAdjacentHTML("beforeend",'<link rel="stylesheet" type="text/css" href="https://rawgit.com/PostCo/postco-shopify/master/v1/shopify.min.css">'),$.getScript("https://cdnjs.cloudflare.com/ajax/libs/selectize.js/0.12.1/js/standalone/selectize.min.js").done(function(t,e){initializeSelectize()}).fail(function(t,e,n){console.log("Selectize failed to load")}),$.getScript("https://cdnjs.cloudflare.com/ajax/libs/remodal/1.1.0/remodal.min.js").done(function(t,e){initializeRemodal()}).fail(function(t,e,n){console.log("Remodal failed to load")})}else console.log("inject - no body tag found.")}},s="data-pc-src"
console.log(s)
var c="/plugins/v1/shopify",d=function(e){var n=e.getAttribute(s+c)
o(t(n),function(t){r(t,e)})}
setTimeout(function(){for(var t=i(s),e=0,n=t.length;e<n;e++)d(t[e])},0)}()
var initializeRemodal=function(){$(".remodal").remodal()},initializeSelectize=function(){var t=document.getElementById("postco-plugin"),e=t.dataset.pcApi,n=t.dataset.pcSrc
$("#js-postco-shipping").click(function(){$("#js-postco-widget").hide(),$("#js-postco-fields").attr("disabled",!0)}),$("#js-postco-collect").click(function(){$("#js-postco-widget").show(),$("#js-postco-fields").attr("disabled",!1)}),$("#postco-agent").selectize({preload:!0,valueField:"id",labelField:"name",searchField:["name","address1","address2","zip","city"],render:{option:function(t,e){return'<div data-address1="'+t.address1+'" data-address2="'+t.address2+'" data-city="'+t.city+'" data-zip="'+t.zip+'" data-province="'+t.province+'" data-country="'+t.country+'"><span class="title"><span class="name" style="font-weight:bold;">'+t.name+'</span></span><br><span class="address" style="font-size: small;">'+(t.address1+" "+t.address2+" "+t.zip+" "+t.city)+"</span></div>"}},onItemAdd:function(t,e){var n=e.text(),o=$(".selectize-dropdown-content").find('[data-value="'+t+'"]'),i=$.param({step:"contact_information",checkout:{shipping_address:{company:n,address1:o.data("address1"),address2:o.data("address2"),city:o.data("city"),zip:o.data("zip"),province:o.data("province"),country:o.data("country")}}})
$("form.cart").attr("action","cart?"+i)},load:function(t,o){this.settings.load=null,$.ajax({url:n+"/api/v1/locations",xhrFields:{withCredentials:!0},headers:{Authorization:"Bearer "+e},type:"GET",error:function(){o()},success:function(t){var e=t.data.map(function(t){return{id:t.attributes["agent-id"],name:t.attributes.company,address1:t.attributes.address1,address2:t.attributes.address2,city:t.attributes.city,zip:t.attributes.zip,province:t.attributes.state,country:t.attributes.country}})
o(e)}})}})}
